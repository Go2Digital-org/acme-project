# Laravel Horizon - Queue Monitoring & Management
# Provides real-time queue monitoring, metrics, and auto-scaling
[program:horizon]
command=php artisan horizon
directory=/app
autostart=true
autorestart=true
startretries=3
startsecs=5
priority=200
user=www-data
environment=
    APP_ENV="%(ENV_APP_ENV)s",
    DB_CONNECTION="%(ENV_DB_CONNECTION)s",
    REDIS_HOST="%(ENV_REDIS_HOST)s",
    QUEUE_CONNECTION="%(ENV_QUEUE_CONNECTION)s"
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
killasgroup=true
stopasgroup=true
stopsignal=TERM
stopwaitsecs=30

# Horizon configuration check
[program:horizon-config-check]
command=/bin/bash -c 'php artisan horizon:publish --force > /dev/null 2>&1; php artisan config:cache > /dev/null 2>&1'
directory=/app
autostart=true
autorestart=false
startretries=1
startsecs=0
priority=199
user=www-data
exitcodes=0
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0