# High Priority Queue Workers
# Handles payments and critical real-time operations

# Payment Queue Workers (Production: 2-8 processes)
[program:queue-payments]
process_name=%(program_name)s_%(process_num)02d
command=php artisan queue:work redis --queue=payments --tries=5 --max-time=0 --max-jobs=1000 --memory=256 --timeout=180 --sleep=1
directory=/app
autostart=true
autorestart=true
startretries=3
startsecs=5
priority=400
user=www-data
numprocs=%(ENV_QUEUE_PAYMENTS_WORKERS)s
environment=
    APP_ENV="%(ENV_APP_ENV)s",
    QUEUE_CONNECTION="%(ENV_QUEUE_CONNECTION)s",
    REDIS_HOST="%(ENV_REDIS_HOST)s"
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
killasgroup=true
stopasgroup=true
stopsignal=TERM
stopwaitsecs=300

# Notification Queue Workers (Production: 1-4 processes)  
[program:queue-notifications]
process_name=%(program_name)s_%(process_num)02d
command=php artisan queue:work redis --queue=notifications --tries=3 --max-time=0 --max-jobs=500 --memory=128 --timeout=120 --sleep=2
directory=/app
autostart=true
autorestart=true
startretries=3
startsecs=5
priority=401
user=www-data
numprocs=%(ENV_QUEUE_NOTIFICATIONS_WORKERS)s
environment=
    APP_ENV="%(ENV_APP_ENV)s",
    QUEUE_CONNECTION="%(ENV_QUEUE_CONNECTION)s",
    REDIS_HOST="%(ENV_REDIS_HOST)s"
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
killasgroup=true
stopasgroup=true
stopsignal=TERM
stopwaitsecs=180