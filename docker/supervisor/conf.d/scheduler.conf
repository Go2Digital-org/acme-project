# Laravel Scheduler - Cron Job Management
# Handles scheduled tasks without requiring system cron
[program:scheduler]
command=php artisan schedule:work --verbose
directory=/app
autostart=true
autorestart=true
startretries=3
startsecs=1
priority=300
user=www-data
environment=
    APP_ENV="%(ENV_APP_ENV)s",
    DB_CONNECTION="%(ENV_DB_CONNECTION)s"
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
killasgroup=true
stopasgroup=true
stopsignal=TERM
stopwaitsecs=60

# Schedule runner fallback (traditional cron-like approach)
[program:schedule-fallback]
command=/bin/bash -c 'while true; do php artisan schedule:run --verbose --no-interaction && sleep 60; done'
directory=/app
autostart=false
autorestart=true
startretries=3
startsecs=1
priority=301
user=www-data
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
killasgroup=true
stopasgroup=true